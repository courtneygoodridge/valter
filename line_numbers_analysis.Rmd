---
title: "lie_numbers_analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages}

# data vis
library(ggplot2) # for plotting
library(scales) # Scale Functions for Visualization

# data manipulation
library(dplyr) # data manipulation
library(tidyr) # data manipulation
library(readxl) # reading excel files 

# stats
library(car) # inferential stats
library(MASS) # inferential stats
library(EnvStats) # inferential stats

# frequetist modelling/multi-level modelling
library(lme4) # for linear mixed effects modelling
library(nlme) # non linear mixed effects modelling
library(fitdistrplus) # fitting distribution modelling 
library(lmtest) # testing linear regression models
library(caret) # classification and regression training
library(merTools) # multi leveling modelling

# bayesian modelling
library(rstanarm) # for bayesian modelling
library(bayesplot) # for bayesian modelling
library(loo) # comparison of bayesian modelling


```

```{r data upload} 
# rm(list = ls())

# load control data
# set working directory on personal laptop
setwd("C:/Users/Courtney/Documents/PhD/Valter")
temp = list.files(pattern = c("ValterDataControl")) # list all CSV files in the directory
myfiles = lapply(temp, read.csv) # read these CSV in the directory
controldata<- do.call(rbind.data.frame, myfiles) # convert and combine the CSV files into dataframe

# load experiment data
temp = list.files(pattern = c("ValterDataExp")) # list all CSV files in the directory
myfiles = lapply(temp, read.csv) # read these CSV in the directory
expdata<- do.call(rbind.data.frame, myfiles) # convert and combine the CSV files into dataframe

```

**Experiment description**

Participants are told that they are hackers that have stolen codes. The police want to crack the code but participants have to communicate codes to their lawyers without being caught.

**Control condition** 

Participants shown just picture of the lawyers and a number. Participants have to respond with equivalent number (odd or even). 

**Experimental condition**

In the lie condition, sometimes the picture was the lawyer and other times it was the cop. When it was the cop, they had to lie (i.e. they had to repond with the opposite key. If the number was odd they had to respond as if it was even). 

In this lie condition, there are trials where the participant has to answer truthfully and also has to lie. 

```{r data cleaning}

# cleaning and renaming control condition
controldata <- controldata %>%
  dplyr::select(numbers, condition, key, accuracy, RTs, participant) %>%
  arrange(participant) %>%
  mutate(condition = "controltrue")

# cleaning experimental conditon
expdata <- expdata %>%
  dplyr::select(numbers, condition, key, accuracy, RTs, participant) %>%
  arrange(participant)

# renaming experimental true trials
exptrue <- expdata %>%
  dplyr::filter(condition == "t") %>%
  mutate(condition = "exptrue")

# renaming experimental lie trials

explie <- expdata %>%
  dplyr::filter(condition == "l") %>%
  mutate(condition = "explie")

workingdata <- rbind(controldata, exptrue, explie)

# creating handedness variable
left <- workingdata %>%
  dplyr::filter(key == "a") %>%
  mutate(hand = "left")

right <- workingdata %>%
  dplyr::filter(key == "g") %>%
  mutate(hand = "right")

workingdata <- rbind(left, right)

# creating parity variable
even <- workingdata %>%
  dplyr::filter(numbers %% 2 == 0) %>%
  mutate(parity = "even")

odd <- workingdata %>%
  dplyr::filter(numbers %% 2 == 1) %>%
  mutate(parity = "odd")

workingdata <- rbind(even, odd)

rm(controldata, expdata, explie, exptrue, left, right, even, odd)

```

**Understanding column names and data types**

Key: a = left key, g = right key 

Accuracy: 1 = correct, 0 = incorrect

Condition: controltrue = control condition (truth), exptrue = exp truth condition, explie = exp lie condition

In the **control condition**, they had a standard SNARC with context of being in court

In **experimental conditon** 2/3 trials were true (standard SNARC) whereas the 1/3 of trials participants had to lie.

```{r overview conditions}

# errors in each condition

ggplot(dplyr::filter(workingdata, accuracy == 0) %>%
         group_by(condition) %>%
         summarise(errors = n()), aes(x = condition, y = errors)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = errors)) +
  ggtitle("Number of errors per condition") +
  theme_gray() 

# mean RTS in each condition for correct repsonses

ggplot(dplyr::filter(workingdata, accuracy == 0) %>%
         group_by(condition) %>%
         summarise(meanRT = mean(RTs)), aes(x = condition, y = meanRT)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = meanRT)) +
  ggtitle("Mean reaction time (s)") +
  theme_gray() 


```

```{r ONLY LAYWER - control condition (RT)}

ggplot(data = workingdata %>%
         dplyr::filter(condition == "controltrue") %>%
         dplyr::group_by(numbers, hand) %>%
         summarise(meanRT = mean(RTs)), aes(x = numbers, y = meanRT, col = hand)) +
  geom_point() +
  geom_line()


```


